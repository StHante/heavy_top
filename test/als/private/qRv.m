function rslt = qRv(p)

rslt(1:3) = [p(1)*p(1) + p(2)*p(2) - p(3)*p(3) - p(4)*p(4), 2*(p(2)*p(3) + p(1)*p(4)), 2*(p(2)*p(4) - p(1)*p(3))];
rslt(4:6) = [2*(p(1)*p(3) + p(2)*p(4)), 2*(p(3)*p(4) - p(1)*p(2)), p(1)*p(1) - p(2)*p(2) - p(3)*p(3) + p(4)*p(4)];
rslt(7:9) = [2*(p(2)*p(3) - p(1)*p(4)), p(1)*p(1) - p(2)*p(2) + p(3)*p(3) - p(4)*p(4), 2*(p(1)*p(2) + p(3)*p(4))];